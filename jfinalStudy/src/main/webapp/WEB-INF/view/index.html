<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="/js/jquery-1.9.1.min.js"></script>
</head>
<body>
<div>
    <ul>
        <li>
            <span>上&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;传：</span>
            <span class="input">
                          <input type="file" id="upfile" name="upfile" placeholder=""/>
                     </span>
            <button onclick="importExp();">导入</button>
            <span>格式：.xls</span>
        </li>
    </ul>

</div>
<script type="text/javascript">

    /*function importExp() {
        var formData = new FormData();
        var name = $("#upfile").val();
        formData.append("file",$("#upfile")[0].files[0]);
        formData.append("name",name);
        $.ajax({
            url:'/excel',
            type : 'POST',
            async : false,
            data : formData,
            // 告诉jQuery不要去处理发送的数据
            processData : false,
            // 告诉jQuery不要去设置Content-Type请求头
            contentType : false,
            beforeSend:function(){
                console.log("正在进行，请稍候");
            },
            success : function(data) {
                // alert(data.returnMsg);
                alert("导出数据成功");
            }
        });
    }*/


    function importExp() {
        var formData = new FormData();
        var name = $("#upfile").val();
        formData.append("file",$("#upfile")[0].files[0]);
        formData.append("name",name);
        $.ajax({
            url:'/excel',
            type : 'POST',
            async : false,
            data : formData,
            // 告诉jQuery不要去处理发送的数据
            processData : false,

            // 告诉jQuery不要去设置Content-Type请求头
            contentType : false,
            beforeSend:function(){
                console.log("正在进行，请稍候");
            },
            success : function(data) {
                // alert(data.returnMsg);
                alert("导出数据成功");
            }
        });
    }


</script>
</body>
</html>